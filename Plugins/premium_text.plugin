__id__ = "premium_text"
__name__ = "Premium Text"
__description__ = "ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµÑ‚ Ñ‚ĞµĞºÑÑ‚ Ğ² ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸"
__author__ = "@ArThirtyFour"
__min_version__ = "11.9.0"
__version__ = "1.1.0"
__icon__ = "yunochkaaaaaaa/0"

from base_plugin import BasePlugin, HookResult, HookStrategy
from client_utils import send_message
from markdown_utils import parse_markdown
from java.util import ArrayList
from android_utils import log

emoji_list = {
    'Ğ°': '[ğŸ”¤](5442667851246742007)',
    'Ğ±': '[ğŸ”¤](5442708515997100433)',
    'Ğ²': '[ğŸ”¤](5449413294953606262)',
    'Ğ³': '[ğŸ”¤](5452141660043488430)',
    'Ğ´': '[ğŸ”¤](5451814740017817067)',
    'Ğµ': '[ğŸ”¤](5195169080914486911)',
    'Ñ‘': '[ğŸ”¤](5197457624173389781)',
    'Ğ¶': '[ğŸ”¤](5452108017564657802)',
    'Ğ·': '[ğŸ”¤](5472327074326786286)',
    'Ğ¸': '[ğŸ”¤](5449768699202381205)',
    'Ğ¹': '[ğŸ”¤](5195365902085792989)',
    'Ğº': '[ğŸ”¤](5456289915551622074)',
    'Ğ»': '[ğŸ”¤](5474517911374668774)',
    'Ğ¼': '[ğŸ”¤](5469720553164122863)',
    'Ğ½': '[ğŸ”¤](5469708475716085118)',
    'Ğ¾': '[ğŸ”¤](5449645429346020359)',
    'Ğ¿': '[ğŸ”¤](5456332233864391674)',
    'Ñ€': '[ğŸ”¤](5465662534918875863)',
    'Ñ': '[ğŸ”¤](5463032576119679082)',
    'Ñ‚': '[ğŸ”¤](5442819107110004737)',
    'Ñƒ': '[ğŸ”¤](5188633966051076002)',
    'Ñ„': '[ğŸ”¤](5199539798548687111)',
    'Ñ…': '[ğŸ”¤](5453904585204704787)',
    'Ñ†': '[ğŸ”¤](5199431226070412282)',
    'Ñ‡': '[ğŸ”¤](5204235000962098442)',
    'Ñˆ': '[ğŸ”¤](5451785663089224462)',
    'Ñ‰': '[ğŸ”¤](5201857350016708252)',
    'ÑŠ': '[ğŸ”¤](5472079100094982899)',
    'Ñ‹': '[ğŸ”¤](5190588236300296545)',
    'ÑŒ': '[ğŸ”¤](5472419270094760054)',
    'Ñ': '[ğŸ”¤](5447451113374624122)',
    'Ñ': '[ğŸ”¤](5188362206290388816)',
    'Ñ': '[ğŸ”¤](5204256643302303428)',
    '1': '[1ï¸âƒ£](5235776368905562305)',
    '2': '[2ï¸âƒ£](5237704680372447424)',
    '3': '[3ï¸âƒ£](5238044171767393675)',
    '4': '[4ï¸âƒ£](5235533321001250232)',
    '5': '[5ï¸âƒ£](5238171599152097811)',
    '6': '[6ï¸âƒ£](5235500881113263583)',
    '7': '[7ï¸âƒ£](5237875542761417785)',
    '8': '[8ï¸âƒ£](5238067300166281132)',
    '9': '[9ï¸âƒ£](5237872923189090057)',
    '0': '[0ï¸âƒ£](5238055991517390123)',
    '!': '[ğŸ”¤](5211108619377977503)',
    '?': '[ğŸ”¤](5210880311801423356)',
    '(': '[ğŸ”¤](5256085766009793165)',
    ')': '[ğŸ”¤](5255844096789983205)',
    '.': '[ğŸ”¤](5255831662859660095)',
    ',': '[ğŸ”¤](5255809805771090545)',
    ' ': '[ğŸ”¤](4992465913241404107)',
    'a': '[ğŸ”¤](5226734466315067436)',
    'b': '[ğŸ”¤](5330453760395191684)',
    'c': '[ğŸ”¤](5330523098347218561)',
    'd': '[ğŸ”¤](5361630910816984823)',
    'e': '[ğŸ”¤](5332587336939084375)',
    'f': '[ğŸ”¤](5330369145244491360)',
    'g': '[ğŸ”¤](5361861335812416268)',
    'h': '[ğŸ”¤](5330133162561380231)',
    'i': '[ğŸ”¤](5381808177547321132)',
    'j': '[ğŸ”¤](5330383228442258084)',
    'k': '[ğŸ”¤](5330026574357996347)',
    'l': '[ğŸ”¤](5332396623211274002)',
    'm': '[ğŸ”¤](5332321341024508571)',
    'n': '[ğŸ”¤](5359736027080565026)',
    'o': '[ğŸ”¤](5361583176550457135)',
    'p': '[ğŸ”¤](5361909160273255840)',
    'q': '[ğŸ”¤](5361948540828393629)',
    'r': '[ğŸ”¤](5332514996804918116)',
    's': '[ğŸ”¤](5332807088940785741)',
    't': '[ğŸ”¤](5332558333024934589)',
    'u': '[ğŸ”¤](5330069773139059849)',
    'v': '[ğŸ”¤](5395613572531232916)',
    'w': '[ğŸ”¤](5332308237079288987)',
    'x': '[ğŸ”¤](5332575697577714724)',
    'y': '[ğŸ”¤](5332648110726323166)',
    'z': '[ğŸ”¤](5330309934825351007)'
}

class PremiumTextPlugin(BasePlugin):
    def on_plugin_load(self):
        log("[PremiumText] Plugin loaded")
        self.add_on_send_message_hook()
        log("[PremiumText] Hook registered")
        
    def on_plugin_unload(self):
        log("[PremiumText] Plugin unloaded")
        self.remove_hook("on_send_message")
        
    def on_send_message_hook(self, account, params):
        log("[PremiumText] Message received")
        log(f"[PremiumText] Message content: {params.message if hasattr(params, 'message') else 'No message'}")
        
        if not hasattr(params, 'message') or not isinstance(params.message, str):
            log("[PremiumText] Invalid message format")
            return HookResult()
            
        message_text = params.message.strip()
        log(f"[PremiumText] Stripped message: {message_text}")
        
        if message_text.startswith('.prem_text'):
            log("[PremiumText] Command detected")
            if len(message_text.split(' ')) == 1:
                log("[PremiumText] No text provided")
                send_message({
                    "peer": params.peer,
                    "message": "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚ Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ .prem_text"
                })
                return HookResult(strategy=HookStrategy.CANCEL)
            else:
                log("[PremiumText] Processing text")
                message_for_da = ' '.join(message_text.split(' ')[1:])
                result = ''
                for char in message_for_da.lower():
                    if char in emoji_list:
                        result += emoji_list[char]
                    else:
                        result += char
                
                log(f"[PremiumText] Sending result: {result}")
                parsed_message = parse_markdown(result)
                send_message({
                    "peer": params.peer,
                    "message": parsed_message.text,
                    "entities": [entity.to_tlrpc_object() for entity in parsed_message.entities]
                })
                return HookResult(strategy=HookStrategy.CANCEL)
                
        return HookResult()

            