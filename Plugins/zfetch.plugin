"""

 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 â•šâ•â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â•â•   â•šâ•â•â•â•  â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•    â•šâ•â•â•â•â•â•    â•šâ•â•   â•šâ•â•  â•šâ•â•   

                                â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
                               â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘
                               â–‘â–ˆâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ˆâ–‘
                               â–‘â–ˆâ•‘ âš–ï¸  Ğ›Ğ˜Ğ¦Ğ•ĞĞ—Ğ˜Ğ ĞĞ’ĞĞĞ ĞŸĞĞ” MIT âš–ï¸   â•‘â–ˆâ–‘
                               â–‘â–ˆâ•‘     Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞĞ˜Ğ• Ğ ĞĞ—Ğ Ğ•Ğ¨Ğ•ĞĞ     â•‘â–ˆâ–‘
                               â–‘â–ˆâ•‘   Â©ï¸ 2025 Ğ¡Ğ²Ğ°Ğ³Ğ°ĞĞµĞ¢ÑƒÑ‚Ğ° Corp.     â•‘â–ˆâ–‘
                               â–‘â–ˆâ•‘                                â•‘â–ˆâ–‘
                               â–‘â–ˆâ•‘  ğŸ”’ Ğ—ĞĞ©Ğ˜Ğ©Ğ•ĞĞ ĞĞ’Ğ¢ĞĞ Ğ¡ĞšĞ˜Ğœ ĞŸĞ ĞĞ’ĞĞœ  â•‘â–ˆâ–‘
                               â–‘â–ˆâ•‘     â­ ĞŸĞ Ğ•ĞœĞ˜Ğ£Ğœ ĞšĞĞ§Ğ•Ğ¡Ğ¢Ğ’Ğ â­     â•‘â–ˆâ–‘
                               â–‘â–ˆâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ˆâ–‘
                               â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘
                                â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
                                
                                
                            	â–‘â–‘â–’â–’â–“â–“â–ˆâ–ˆ ĞŸĞĞ”ĞŸĞ˜Ğ¡Ğ¬ Ğ¡ĞĞ—Ğ”ĞĞ¢Ğ•Ğ›Ğ¯ â–ˆâ–ˆâ–“â–“â–’â–’â–‘â–‘
                                    	   Ğ¡Ğ²Ğ°Ğ³Ğ°ĞĞµĞ¢ÑƒÑ‚Ğ° â„¢
                              	      âš–ï¸ ğŸ“‹ ğŸ” Â©ï¸ Â® â„¢ â­ ğŸ–ï¸ ğŸ…
                            	   Ğ’ÑĞµ Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ñ‹ â€¢ 2025 Ğ³Ğ¾Ğ´
"""

# --- Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¯ 4.0 Z (Ğ¡ĞĞ’ĞœĞ•Ğ¡Ğ¢Ğ˜ĞœĞĞ¯) ---

import traceback
from android.os import Build, SystemClock
from android.app import ActivityManager
from android.content import Context
from java.util import ArrayList
from org.telegram.messenger import ApplicationLoader, UserConfig
from base_plugin import BasePlugin, HookResult, HookStrategy
from client_utils import get_user_config
from org.telegram.tgnet import TLRPC

__id__ = "zfetch"
__name__ = "Z-Art (ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹)"
__description__ = "ĞŸĞ°Ñ‚Ñ€Ğ¸Ğ¾Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ASCII-Ğ°Ñ€Ñ‚, Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²."
__author__ = "Ğ ĞµĞ´Ğ°ĞºÑ†Ğ¸Ñ Z Ğ¾Ñ‚ Ğ¡Ğ²Ğ°Ğ³Ğ°ĞĞµĞ¢ÑƒÑ‚Ğ°"
__min_version__ = "11.9.1"
__icon__ = "GOIDA_LUTAYA/22"
__version__ = "4.0 Z final"


class ZArtPlugin(BasePlugin):
    def on_plugin_load(self):
        self.add_on_send_message_hook()

    def on_send_message_hook(self, account, params):
        # ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° .zfetch (Ğ½Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°)
        if not isinstance(params.message, str) or not params.message.lower().startswith(".zfetch"):
            return HookResult()

        try:
            # 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ‚ĞµĞºÑÑ‚ Ñ ASCII-Ğ°Ñ€Ñ‚Ğ¾Ğ¼
            text = self._create_z_art()
            params.message = text

            # 2. ĞĞ±Ğ¾Ñ€Ğ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ² Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¾ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑˆÑ€Ğ¸Ñ„Ñ‚Ğ°
            if not hasattr(params, "entities") or params.entities is None:
                params.entities = ArrayList()
            
            entity = TLRPC.TL_messageEntityPre() # Ğ›ÑƒÑ‡ÑˆĞ¸Ğ¹ Ñ‚Ğ¸Ğ¿ Ğ´Ğ»Ñ ASCII-Ğ°Ñ€Ñ‚Ğ°
            entity.language = ""
            entity.offset = 0
            entity.length = len(text.encode('utf-16-le')) // 2
            params.entities.clear()
            params.entities.add(entity)

        except Exception:
            params.message = f"ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ™ Ğ¡Ğ‘ĞĞ™ ğŸ‡·ğŸ‡º\n\n{traceback.format_exc()}"
        
        # 3. Ğ“Ğ›ĞĞ’ĞĞĞ• Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ•: ÑÑ‚Ğ° ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰Ğ°ĞµÑ‚ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°Ğ¼
        # Ñ‚Ñ€Ğ¾Ğ³Ğ°Ñ‚ÑŒ ÑÑ‚Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ½Ğ°ÑˆĞµĞ³Ğ¾.
        return HookResult(strategy=HookStrategy.MODIFY_FINAL, params=params)

    def _create_z_art(self):
        # --- Ğ¡Ğ±Ğ¾Ñ€ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ ---
        user_config = get_user_config()
        user_id = user_config.getClientUserId()
        
        device = f"{Build.MANUFACTURER} {Build.MODEL}"
        os_ver = f"Android {Build.VERSION.RELEASE}"
        
        cpu = Build.SOC_MODEL if hasattr(Build, "SOC_MODEL") and Build.SOC_MODEL else Build.BOARD

        uptime_ms = SystemClock.elapsedRealtime()
        uptime_seconds = int(uptime_ms / 1000)
        days = uptime_seconds // 86400
        hours = (uptime_seconds % 86400) // 3600
        minutes = (uptime_seconds % 3600) // 60
        uptime_str = f"{days}Ğ´ {hours}Ñ‡ {minutes}Ğ¼"

        context = ApplicationLoader.applicationContext
        activity_manager = context.getSystemService(Context.ACTIVITY_SERVICE)
        mem_info = ActivityManager.MemoryInfo()
        activity_manager.getMemoryInfo(mem_info)
        total_mem = mem_info.totalMem / (1024 * 1024)
        used_mem = total_mem - mem_info.availMem
        memory_str = f"{int(used_mem)}MB / {int(total_mem)}MB"

        # --- Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ASCII-Ğ°Ñ€Ñ‚Ğ° Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸ ---
        art_block = f"""
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   ĞŸĞ¾Ğ·Ñ‹Ğ²Ğ½Ğ¾Ğ¹: {user_id}
â•šâ•â•â•â•â–ˆâ–ˆâ•‘   ------------------------------------
          â–ˆâ–ˆâ•”â•     Ğ‘ĞŸĞ›Ğ-ĞºĞ¾Ğ¼Ğ¼ÑƒÑ‚Ğ°Ñ‚Ğ¾Ñ€: {device}
        â–ˆâ–ˆâ•”â•       Ğ’ĞµÑ€ÑĞ¸Ñ Ğ Ğ¾ÑĞĞ¡: {os_ver}
    â–ˆâ–ˆâ•”â•           Ğ’Ñ€ĞµĞ¼Ñ Ğ² ÑÑ‚Ñ€Ğ¾Ñ: {uptime_str}
 â–ˆâ–ˆâ•”â•              Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚. Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ: {cpu}
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   Ğ‘Ğ¾ĞµĞ·Ğ°Ğ¿Ğ°Ñ ĞĞ—Ğ£: {memory_str}
â•šâ•â•â•â•â•â•â•   Ğ ĞĞ‘ĞĞ¢ĞĞ™Ğ¢Ğ•, Ğ‘Ğ ĞĞ¢Ğ¬Ğ¯! Z Ğ—Ğ Ğ ĞĞ¡Ğ¡Ğ˜Ğ® ĞœĞĞ¢Ğ£Ğ¨ĞšĞ£! Ğ—Ğ Ğ ĞĞ”Ğ˜ĞĞ£!
"""
        return art_block.strip()
